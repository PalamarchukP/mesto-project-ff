/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){var t,n,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",u=o.toStringTag||"@@toStringTag";function c(e,o,i,u){var c=o&&o.prototype instanceof l?o:l,s=Object.create(c.prototype);return r(s,"_invoke",function(e,r,o){var i,u,c,l=0,s=o||[],p=!1,f={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,r){return i=e,u=0,c=t,f.n=r,a}};function y(e,r){for(u=e,c=r,n=0;!p&&l&&!o&&n<s.length;n++){var o,i=s[n],y=f.p,d=i[2];e>3?(o=d===r)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=e<2&&y<i[1])?(u=0,f.v=r,f.n=i[1]):y<d&&(o=e<3||i[0]>r||r>d)&&(i[4]=e,i[5]=r,f.n=d,u=0))}if(o||e>1)return a;throw p=!0,r}return function(o,s,d){if(l>1)throw TypeError("Generator is already running");for(p&&1===s&&y(s,d),u=s,c=d;(n=u<2?t:c)||!p;){i||(u?u<3?(u>1&&(f.n=-1),y(u,c)):f.n=c:f.v=c);try{if(l=2,i){if(u||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=i.return)&&n.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((n=(p=f.n<0)?c:e.call(r,f))!==a)break}catch(e){i=t,u=1,c=e}finally{l=1}}return{value:n,done:p}}}(e,i,u),!0),s}var a={};function l(){}function s(){}function p(){}n=Object.getPrototypeOf;var f=[][i]?n(n([][i]())):(r(n={},i,(function(){return this})),n),y=p.prototype=l.prototype=Object.create(f);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,r(t,u,"GeneratorFunction")),t.prototype=Object.create(y),t}return s.prototype=p,r(y,"constructor",p),r(p,"constructor",s),s.displayName="GeneratorFunction",r(p,u,"GeneratorFunction"),r(y),r(y,u,"Generator"),r(y,i,(function(){return this})),r(y,"toString",(function(){return"[object Generator]"})),(e=function(){return{w:c,m:d}})()}function r(t,e,n,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}r=function(t,e,n,o){if(e)i?i(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n;else{function u(e,n){r(t,e,(function(t){return this._invoke(e,n,t)}))}u("next",0),u("throw",1),u("return",2)}},r(t,e,n,o)}function n(t,e,r,n,o,i,u){try{var c=t[i](u),a=c.value}catch(t){return void r(t)}c.done?e(a):Promise.resolve(a).then(n,o)}var o="DELETE",i="PATCH",u={baseUrl:"https://nomoreparties.co/v1/wff-cohort-41/",headers:{authorization:"4137014f-17d6-4069-af09-c5b9f7fc2b66","Content-Type":"application/json"}};function c(t,e,r){return a.apply(this,arguments)}function a(){var r;return r=e().m((function r(n,o,i){var c,a=arguments;return e().w((function(e){for(;;)if(0===e.n)return c=a.length>3&&void 0!==a[3]?a[3]:"",e.a(2,fetch("".concat(u.baseUrl).concat(o,"/").concat(c),(r={method:n,headers:u.headers},l=i?"body":"",s=i?JSON.stringify(i):null,(l=function(e){var r=function(e){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(r)?r:r+""}(l))in r?Object.defineProperty(r,l,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[l]=s,r)).then((function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))})).catch((function(t){throw t})));var r,l,s}),r)})),a=function(){var t=this,e=arguments;return new Promise((function(o,i){var u=r.apply(t,e);function c(t){n(u,o,i,c,a,"next",t)}function a(t){n(u,o,i,c,a,"throw",t)}c(void 0)}))},a.apply(this,arguments)}function l(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var a=n&&n.prototype instanceof c?n:c,l=Object.create(a.prototype);return s(l,"_invoke",function(r,n,o){var i,c,a,l=0,s=o||[],p=!1,f={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,r){return i=e,c=0,a=t,f.n=r,u}};function y(r,n){for(c=r,a=n,e=0;!p&&l&&!o&&e<s.length;e++){var o,i=s[e],y=f.p,d=i[2];r>3?(o=d===n)&&(a=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=r<2&&y<i[1])?(c=0,f.v=n,f.n=i[1]):y<d&&(o=r<3||i[0]>n||n>d)&&(i[4]=r,i[5]=n,f.n=d,c=0))}if(o||r>1)return u;throw p=!0,n}return function(o,s,d){if(l>1)throw TypeError("Generator is already running");for(p&&1===s&&y(s,d),c=s,a=d;(e=c<2?t:a)||!p;){i||(c?c<3?(c>1&&(f.n=-1),y(c,a)):f.n=a:f.v=a);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(p=f.n<0)?a:r.call(n,f))!==u)break}catch(e){i=t,c=1,a=e}finally{l=1}}return{value:e,done:p}}}(r,o,i),!0),l}var u={};function c(){}function a(){}function p(){}e=Object.getPrototypeOf;var f=[][n]?e(e([][n]())):(s(e={},n,(function(){return this})),e),y=p.prototype=c.prototype=Object.create(f);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,o,"GeneratorFunction")),t.prototype=Object.create(y),t}return a.prototype=p,s(y,"constructor",p),s(p,"constructor",a),a.displayName="GeneratorFunction",s(p,o,"GeneratorFunction"),s(y),s(y,o,"Generator"),s(y,n,(function(){return this})),s(y,"toString",(function(){return"[object Generator]"})),(l=function(){return{w:i,m:d}})()}function s(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}s=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{function i(e,r){s(t,e,(function(t){return this._invoke(e,r,t)}))}i("next",0),i("throw",1),i("return",2)}},s(t,e,r,n)}function p(t,e,r,n,o,i,u){try{var c=t[i](u),a=c.value}catch(t){return void r(t)}c.done?e(a):Promise.resolve(a).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function u(t){p(i,n,o,u,c,"next",t)}function c(t){p(i,n,o,u,c,"throw",t)}u(void 0)}))}}function y(t,e,r,n,o){var i,u,c=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),a=c.querySelector(".card__image"),l=c.querySelector("#like-counter");c.querySelector(".card__title").textContent=t.name,a.src=t.link,a.alt=t.name,l.textContent=null!==(i=null===(u=t.likes)||void 0===u?void 0:u.length)&&void 0!==i?i:0;var s=c.querySelector(".card__delete-button");s.addEventListener("click",(function(){return e(t,c,o)})),t.owner._id!==o&&c.removeChild(s),a.addEventListener("click",(function(){return r(c)}));var p=c.querySelector(".card__like-button");return t.likes.some((function(t){return t._id===o}))&&p.classList.toggle("card__like-button_is-active"),p.addEventListener("click",(function(){return n(t,c,p)})),c}function d(t,e,r){return v.apply(this,arguments)}function v(){return(v=f(l().m((function t(e,r,n){return l().w((function(t){for(;;)switch(t.n){case 0:if(e.owner._id!==n){t.n=2;break}return t.n=1,c(o,"cards",null,e._id);case 1:r.remove();case 2:return t.a(2)}}),t)})))).apply(this,arguments)}function _(t,e,r){return m.apply(this,arguments)}function m(){return(m=f(l().m((function t(e,r,n){var i,u,a,s,p;return l().w((function(t){for(;;)switch(t.n){case 0:if(i=r.querySelector("#like-counter"),!n.classList.contains("card__like-button_is-active")){t.n=2;break}return t.n=1,c(o,"cards/likes",null,e._id);case 1:u=t.v,a=u.likes,i.textContent=a.length,t.n=4;break;case 2:return t.n=3,c("PUT","cards/likes",null,e._id);case 3:s=t.v,p=s.likes,i.textContent=p.length;case 4:n.classList.toggle("card__like-button_is-active");case 5:return t.a(2)}}),t)})))).apply(this,arguments)}function b(t){t.classList.add("popup_is-opened"),document.addEventListener("click",S),document.addEventListener("keydown",g)}function h(){document.querySelector(".popup_is-opened").classList.remove("popup_is-opened"),document.removeEventListener("click",S),document.removeEventListener("keydown",g)}function S(t){(t.target.classList.contains("popup__close")||t.target.classList.contains("popup"))&&h()}function g(t){"Escape"===t.key&&h()}var w=function(t,e,r){var n=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(r.inputErrorClass),n.classList.remove(r.inputErrorActive),e.setCustomValidity(""),n.textContent=""},k=function(t,e){var r=Array.from(t.querySelectorAll(e.inputSelector)),n=t.querySelector(e.submitButtonSelector);r.forEach((function(r){w(t,r,e)})),q(r,n,e)},q=function(t,e,r){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.disabled=!1,e.classList.remove(r.inactiveButtonClass)):(e.disabled=!0,e.classList.add(r.inactiveButtonClass))};function E(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var a=n&&n.prototype instanceof c?n:c,l=Object.create(a.prototype);return j(l,"_invoke",function(r,n,o){var i,c,a,l=0,s=o||[],p=!1,f={p:0,n:0,v:t,a:y,f:y.bind(t,4),d:function(e,r){return i=e,c=0,a=t,f.n=r,u}};function y(r,n){for(c=r,a=n,e=0;!p&&l&&!o&&e<s.length;e++){var o,i=s[e],y=f.p,d=i[2];r>3?(o=d===n)&&(a=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=y&&((o=r<2&&y<i[1])?(c=0,f.v=n,f.n=i[1]):y<d&&(o=r<3||i[0]>n||n>d)&&(i[4]=r,i[5]=n,f.n=d,c=0))}if(o||r>1)return u;throw p=!0,n}return function(o,s,d){if(l>1)throw TypeError("Generator is already running");for(p&&1===s&&y(s,d),c=s,a=d;(e=c<2?t:a)||!p;){i||(c?c<3?(c>1&&(f.n=-1),y(c,a)):f.n=a:f.v=a);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(p=f.n<0)?a:r.call(n,f))!==u)break}catch(e){i=t,c=1,a=e}finally{l=1}}return{value:e,done:p}}}(r,o,i),!0),l}var u={};function c(){}function a(){}function l(){}e=Object.getPrototypeOf;var s=[][n]?e(e([][n]())):(j(e={},n,(function(){return this})),e),p=l.prototype=c.prototype=Object.create(s);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,j(t,o,"GeneratorFunction")),t.prototype=Object.create(p),t}return a.prototype=l,j(p,"constructor",l),j(l,"constructor",a),a.displayName="GeneratorFunction",j(l,o,"GeneratorFunction"),j(p),j(p,o,"Generator"),j(p,n,(function(){return this})),j(p,"toString",(function(){return"[object Generator]"})),(E=function(){return{w:i,m:f}})()}function j(t,e,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}j=function(t,e,r,n){if(e)o?o(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r;else{function i(e,r){j(t,e,(function(t){return this._invoke(e,r,t)}))}i("next",0),i("throw",1),i("return",2)}},j(t,e,r,n)}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function C(t,e,r,n,o,i,u){try{var c=t[i](u),a=c.value}catch(t){return void r(t)}c.done?e(a):Promise.resolve(a).then(n,o)}function L(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function u(t){C(i,n,o,u,c,"next",t)}function c(t){C(i,n,o,u,c,"throw",t)}u(void 0)}))}}var T,P=document.querySelector(".places__list"),x=document.querySelector(".profile__title"),G=document.querySelector(".profile__description"),A=document.querySelector(".profile__image"),F=document.querySelector(".profile__edit-button"),B=document.querySelector(".profile__add-button"),I=document.querySelector(".popup_type_edit"),N=document.querySelector(".popup_type_new-card"),D=document.querySelector(".popup_type_avatar"),M=document.querySelector(".profile__title"),U=document.querySelector(".profile__description"),V=I.querySelector(".popup__form"),z=N.querySelector(".popup__form"),H=D.querySelector(".popup__form"),J=V.querySelector(".popup__input_type_name"),$=V.querySelector(".popup__input_type_description"),K=z.querySelector(".popup__input_type_card-name"),Q=z.querySelector(".popup__input_type_url"),R=H.querySelector(".popup__input_type_url"),W=V.querySelector(".popup__button"),X=z.querySelector(".popup__button"),Y=H.querySelector(".popup__button"),Z=document.querySelector(".popup_type_image"),tt=Z.querySelector(".popup__image"),et=Z.querySelector(".popup__caption"),rt={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",inputErrorActive:"popup__input-error_active",errorClass:"popup__error_visible"};function nt(){return(nt=L(E().m((function t(e){var r,n,o,u,a;return E().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),ut(!0,W),t.p=1,r=J.value,n=$.value,o={name:r,about:n},t.n=2,c(i,"users/me",o);case 2:u=t.v,M.textContent=u.name,U.textContent=u.about,h(),t.n=4;break;case 3:t.p=3,a=t.v,console.error(a);case 4:return t.p=4,ut(!1,W),t.f(4);case 5:return t.a(2)}}),t,null,[[1,3,4,5]])})))).apply(this,arguments)}function ot(){return(ot=L(E().m((function t(e){var r,n,o,i,u,a,l;return E().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),ut(!0,X),t.p=1,r=K.value,n=Q.value,o={name:r,link:n},t.n=2,c("POST","cards",o);case 2:i=t.v,u=T._id,a=y(i,d,ct,_,u),P.insertBefore(a,P.firstChild),h(),e.target.reset(),t.n=4;break;case 3:t.p=3,l=t.v,console.error(l);case 4:return t.p=4,ut(!0,X),t.f(4);case 5:return t.a(2)}}),t,null,[[1,3,4,5]])})))).apply(this,arguments)}function it(){return(it=L(E().m((function t(e){var r,n,o,u;return E().w((function(t){for(;;)switch(t.n){case 0:return e.preventDefault(),ut(!0,Y),t.p=1,r=R.value,n={avatar:r},t.n=2,c(i,"users/me/avatar",n);case 2:o=t.v,A.style.backgroundImage="url(".concat(o.avatar,")"),h(),e.target.reset(),t.n=4;break;case 3:t.p=3,u=t.v,console.error(u);case 4:return t.p=4,ut(!1,Y),t.f(4);case 5:return t.a(2)}}),t,null,[[1,3,4,5]])})))).apply(this,arguments)}function ut(t,e){e.textContent=t?"Сохранение...":"Сохранить"}function ct(t){var e=t.querySelector(".card__image"),r=e.src,n=e.alt;tt.src=r,tt.alt=n,et.textContent=n,b(Z)}!function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(e){!function(t,e){var r=Array.from(t.querySelectorAll(e.inputSelector)),n=t.querySelector(e.submitButtonSelector);q(r,n,e),r.forEach((function(o){o.addEventListener("input",(function(){!function(t,e,r){var n=e.validity;n.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),n.valid?w(t,e,r):function(t,e,r,n){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.add(n.inputErrorClass),o.textContent=r,o.classList.add(n.errorClass)}(t,e,e.validationMessage,r)}(t,o,e),q(r,n,e)}))}))}(e,t)}))}(rt),document.querySelectorAll(".popup").forEach((function(t){return t.classList.add("popup_is-animated")})),F.addEventListener("click",(function(){J.value=M.textContent,$.value=U.textContent,b(I),k(V,rt)})),B.addEventListener("click",(function(){b(N),z.reset(),k(z,rt)})),A.addEventListener("click",(function(){b(D),H.reset(),k(H,rt)})),V.addEventListener("submit",(function(t){return nt.apply(this,arguments)})),z.addEventListener("submit",(function(t){return ot.apply(this,arguments)})),H.addEventListener("submit",(function(t){return it.apply(this,arguments)})),Promise.all([c("GET","users/me"),c("GET","cards")]).then((function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,u,c=[],a=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;a=!1}else for(;!(a=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);a=!0);}catch(t){l=!0,o=t}finally{try{if(!a&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(l)throw o}}return c}}(e,r)||function(t,e){if(t){if("string"==typeof t)return O(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],i=n[1];T=o,i.forEach((function(t){var e=y(t,d,ct,_,T._id);P.append(e)})),x.textContent=T.name,G.textContent=T.about,A.style.backgroundImage="url(".concat(T.avatar,")")})).catch((function(t){console.error(t)}))})();